<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:b="http://bootsfaces.net/ui">
<h:body>
	<ui:composition template="/pages/template.xhtml">
		<ui:define name="content">
			<b:panel rendered="#{profileBean.hasRole('admin')}" title="Administration" collapsible="false">
			  <b:alert severity="info" closable="true">
          <h:outputText value="Der RSS-Feed des Administrators lautet: " />
          <b:navLink href="https://onkelwernerfreizeiten.de/camporganizer/rss.jsf?recipientCode=admin" target="#" value="https://onkelwernerfreizeiten.de/camporganizer/rss.jsf?recipientCode=admin" iconAwesome="rss" />
        </b:alert>
				<b:tabView activeIndex="#{adminModel.activeIndex}">
					<b:tab title="Rollen verwalten" styleClass="dist16">
						<b:form>
							<b:dataTable value="#{adminModel.profileRoles}" var="l" lang="de">
								<b:dataTableColumn label="Nutzer">
									<h:outputText value="#{l.user.fullname}" />
									<f:facet name="footer">
										<b:selectOneMenu value="#{adminModel.profileRole.user}">
											<f:selectItems value="#{adminModel.users}" var="u" itemLabel="#{u.fullname}" itemValue="#{u}" />
										</b:selectOneMenu>
									</f:facet>
								</b:dataTableColumn>
								<b:dataTableColumn label="Rolle">
									<h:outputText value="#{l.role}" />
									<f:facet name="footer">
										<b:selectOneMenu value="#{adminModel.profileRole.role}">
											<f:selectItems value="#{adminModel.roles}" var="r" itemValue="#{r}" itemLabel="#{r}" />
										</b:selectOneMenu>
									</f:facet>
								</b:dataTableColumn>
								<b:dataTableColumn label="Aktionen">
									<b:dropButton value="löschen" iconAwesome="trash-o" look="danger">
										<b:commandButton action="#{adminController.doDelete(l)}" value="ja, unwiederbringlich löschen" look="danger" />
									</b:dropButton>
									<f:facet name="footer">
										<b:commandButton action="#{adminController.doInsert}" value="vergeben" look="success" />
									</f:facet>
								</b:dataTableColumn>
							</b:dataTable>
						</b:form>
					</b:tab>
					<b:tab title="Logins verwalten" styleClass="dist16">
						<b:form>
							<b:dataTable value="#{adminModel.users}" var="u" lang="de">
								<b:dataTableColumn label="Name">
									<h:outputText value="#{u.fullname}" />
								</b:dataTableColumn>
								<b:dataTableColumn label="Login">
									<h:outputText value="#{u.username}" />
								</b:dataTableColumn>
								<b:dataTableColumn label="Operationen">
									<b:buttonGroup>
										<b:commandButton action="#{adminController.doResetUserPassword(u)}" iconAwesome="flash" value="Passwort zurücksetzen"
											look="warning" />
										<b:dropButton value="löschen" iconAwesome="trash-o" look="danger">
											<b:commandButton action="#{adminController.doDeleteUser(u)}" value="ja, unwiederbringlich löschen" look="danger" />
										</b:dropButton>
									</b:buttonGroup>
								</b:dataTableColumn>
							</b:dataTable>
						</b:form>
					</b:tab>
					<b:tab title="Freizeitheime" styleClass="dist16">
						<b:tabView activeIndex="#{adminModel.activeIndexLocation}">
							<b:tab title="Tabelle">
								<b:form>
									<b:dataTable value="#{adminModel.locations}" var="l" lang="de">
										<b:dataTableColumn label="ID">
											<b:commandButton action="#{adminController.toEditLocation(l.pk)}" value="#{l.pk}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Name">
											<b:commandButton action="#{adminController.toEditLocation(l.pk)}" value="#{l.name}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Webseite">
											<b:commandButton action="#{adminController.toEditLocation(l.pk)}" value="#{l.showUrl(32)}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Wegbeschreibung">
											<b:commandButton action="#{adminController.doDownloadDocument(l)}" value="" iconAwesome="download"
												rendered="#{l.fkDocument != null}" />
										</b:dataTableColumn>
									</b:dataTable>
								</b:form>
							</b:tab>
							<b:tab title="Element">
								<b:form>
									<b:panelGrid colSpans="3,9" size="xs">
										<h:outputText value="ID = #{adminModel.location.pk}" />
										<b:commandButton action="#{adminController.doResetLocation}" value="Felder leeren" />
										<h:outputText value="Name" />
										<b:inputText value="#{adminModel.location.name}" />
										<h:outputText value="Webseite" />
										<b:inputText value="#{adminModel.location.url}" mask="https{0,1}://*{1,999}" />
										<h:outputText value="Wegbeschreibung" />
										<b:selectOneMenu value="#{adminModel.location.fkDocument}">
											<f:selectItem itemValue="" itemLabel="--- bitte wählen ---" />
											<f:selectItems value="#{adminModel.documents}" var="d" itemValue="#{d.pk}" itemLabel="#{d.name}" />
										</b:selectOneMenu>
										<b:dropButton value="löschen" iconAwesome="trash-o" look="danger">
											<b:commandButton action="#{adminController.doDeleteLocation}" value="ja, unwiederbringlich löschen" look="danger" />
										</b:dropButton>
										<b:commandButton action="#{adminController.doUpsertLocation}" value="Übernehmen" look="primary" />
									</b:panelGrid>
								</b:form>
							</b:tab>
						</b:tabView>
					</b:tab>
					<b:tab title="Freizeiten" styleClass="dist16">
						<b:tabView activeIndex="#{adminModel.activeIndexCamp}">
							<b:tab title="Tabelle">
								<b:form>
									<b:dataTable value="#{adminModel.camps}" var="c" lang="de">
										<b:dataTableColumn label="Name">
											<b:commandButton action="#{adminController.toEditCamp(c.pk)}" value="#{c.name}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Zeit">
											<b:commandButton action="#{adminController.toEditCamp(c.pk)}" value="#{c.campTime}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="in">
											<b:commandButton action="#{adminController.toEditCamp(c.pk)}" value="#{c.locationName}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Bestätigung">
											<b:commandButton action="#{adminController.doDownloadDocument(c)}" value="" iconAwesome="download"
												rendered="#{c.fkDocument != null}" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Anmeldungen">
											<h:outputText value="#{c.bookings}" />
										</b:dataTableColumn>
									</b:dataTable>
								</b:form>
							</b:tab>
							<b:tab title="Element">
								<b:form>
									<b:panelGrid colSpans="3,9" size="xs">
										<h:outputText value="ID = #{adminModel.camp.pk}" />
										<b:commandButton action="#{adminController.doResetCamp}" value="Felder leeren" />
										<h:outputText value="Name" />
										<b:inputText value="#{adminModel.camp.name}" />
										<h:outputText value="von" />
										<b:datepicker value="#{adminModel.camp.arrive}" />
										<h:outputText value="bis" />
										<b:datepicker value="#{adminModel.camp.depart}" />
										<h:outputText value="Freizeitheim" />
										<b:selectOneMenu value="#{adminModel.camp.fkLocation}">
											<f:selectItem itemValue="" itemLabel="--- bitte auswählen ---" />
											<f:selectItems value="#{adminModel.locations}" var="l" itemValue="#{l.pk}" itemLabel="#{l.name}" />
										</b:selectOneMenu>
										<h:outputText value="Mindestalter" />
										<b:inputText value="#{adminModel.camp.minAge}">
											<f:convertNumber integerOnly="true" />
										</b:inputText>
										<h:outputText value="Maximalalter" />
										<b:inputText value="#{adminModel.camp.maxAge}">
											<f:convertNumber integerOnly="true" />
										</b:inputText>
										<h:outputText value="Preis" />
										<b:inputTextarea value="#{adminModel.camp.price}" />
										<h:outputText value="Ferien in" />
										<b:inputText value="#{adminModel.camp.countries}" tags="true" typeahead="true"
											typeaheadValues="#{adminModel.possibleCountries}" />
										<h:outputText value="Bestätigung" />
										<b:selectOneMenu value="#{adminModel.camp.fkDocument}">
											<f:selectItem itemValue="" itemLabel="--- bitte wählen ---" />
											<f:selectItems value="#{adminModel.documents}" var="d" itemValue="#{d.pk}" itemLabel="#{d.name}" />
										</b:selectOneMenu>
										<b:dropButton value="löschen" iconAwesome="trash-o" look="danger">
											<b:commandButton action="#{adminController.doDeleteCamp}" value="ja, unwiederbringlich löschen" look="danger" />
										</b:dropButton>
										<b:commandButton action="#{adminController.doUpsertCamp}" value="Übernehmen" look="primary" />
									</b:panelGrid>
								</b:form>
							</b:tab>
						</b:tabView>
					</b:tab>
					<b:tab title="Dokumente" styleClass="dist16">
						<b:tabView activeIndex="#{adminModel.activeIndexDocument}">
							<b:tab title="Tabelle">
								<b:form>
									<b:dataTable value="#{adminModel.documents}" var="d" lang="de">
										<b:dataTableColumn label="ID">
											<b:commandButton action="#{adminController.toEditDocument(d.pk)}" value="#{d.pk}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Name">
											<b:commandButton action="#{adminController.toEditDocument(d.pk)}" value="#{d.name}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Dokumententyp">
											<b:commandButton action="#{adminController.toEditDocument(d.pk)}" value="#{d.doctype.literal}" look="link" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Inhalt">
											<b:commandButton action="#{adminController.doDownloadDocument(d)}" value="" iconAwesome="download" link="look" />
										</b:dataTableColumn>
										<b:dataTableColumn label="Dateityp">
											<b:commandButton action="#{adminController.toEditDocument(d.pk)}" value="#{d.filetype.literal}" look="link" />
										</b:dataTableColumn>
									</b:dataTable>
								</b:form>
							</b:tab>
							<b:tab title="Element">
								<b:form enctype="multipart/form-data">
									<b:panelGrid colSpans="3,9" size="xs">
										<h:outputText value="ID = #{adminModel.document.pk}" />
										<b:commandButton action="#{adminController.doResetDocument}" value="Felder leeren" />
										<h:outputText value="Name" />
										<b:inputText value="#{adminModel.document.name}" />
										<h:outputText value="Dokumententyp" />
										<b:selectOneMenu value="#{adminModel.document.doctype}">
											<f:selectItem itemValue="" itemLabel="--- bitte wählen ---" />
											<f:selectItems value="#{adminModel.enumlistDoctype}" var="e" itemValue="#{e}" itemLabel="#{e.literal}" />
										</b:selectOneMenu>
										<h:outputText value="Inhalt" />
										<h:inputFile value="#{adminModel.document.uploadfile}" style="padding-bottom: 16px" />
										<h:outputText value="Dateityp" />
										<b:selectOneMenu value="#{adminModel.document.filetype}">
											<f:selectItem itemValue="" itemLabel="--- bitte wählen ---" />
											<f:selectItems value="#{adminModel.enumlistFiletype}" var="e" itemValue="#{e}" itemLabel="#{e.literal}" />
										</b:selectOneMenu>
										<b:dropButton value="löschen" iconAwesome="trash-o" look="danger">
											<b:commandButton action="#{adminController.doDeleteDocument}" value="ja, unwiederbringlich löschen" look="danger" />
										</b:dropButton>
										<b:commandButton action="#{adminController.doUpsertDocument}" value="Übernehmen" look="primary" />
									</b:panelGrid>
								</b:form>
							</b:tab>
						</b:tabView>
					</b:tab>
          <b:tab title="RSS" styleClass="dist16">
            <b:tabView activeIndex="#{adminModel.activeIndexRss}">
              <b:tab title="Tabelle">
                <b:form>
                  <b:dataTable value="#{adminModel.rssList}" var="d" lang="de">
                    <b:dataTableColumn label="ID">
                      <b:commandButton action="#{adminController.toEditRss(d.pk)}" value="#{d.pk}" look="link" />
                    </b:dataTableColumn>
                    <b:dataTableColumn label="Empfänger">
                      <b:commandButton action="#{adminController.toEditRss(d.pk)}" value="#{d.recipient}" look="link" />
                    </b:dataTableColumn>
                    <b:dataTableColumn label="Inhalt">
                      <b:commandButton action="#{adminController.toEditRss(d.pk)}" value="#{d.message}" look="link" />
                    </b:dataTableColumn>
                    <b:dataTableColumn label="Datum">
                      <b:commandButton action="#{adminController.toEditRss(d.pk)}" value="#{d.pubdate}" look="link" />
                    </b:dataTableColumn>
                  </b:dataTable>
                </b:form>
              </b:tab>
              <b:tab title="Element">
                <b:form>
                  <b:panelGrid colSpans="3,9" size="xs">
                    <h:outputText value="ID = #{adminModel.rss.pk}" />
                    <b:commandButton action="#{adminController.doResetRss}" value="Felder leeren" />
                    <h:outputText value="Empfänger" />
                    <h:outputText value="#{adminModel.rss.recipient}" />
                    <h:outputText value="Inhalt" />
                    <b:inputText value="#{adminModel.rss.message}" />
                    <h:outputText value="Datum" />
                    <h:outputText value="#{adminModel.rss.pubdate}" />
                    <b:dropButton value="löschen" iconAwesome="trash-o" look="danger">
                      <b:commandButton action="#{adminController.doDeleteRss}" value="ja, unwiederbringlich löschen" look="danger" />
                    </b:dropButton>
                    <b:commandButton action="#{adminController.doUpdateRss}" value="Übernehmen" look="primary" />
                  </b:panelGrid>
                </b:form>
              </b:tab>
            </b:tabView>
          </b:tab>
				</b:tabView>
			</b:panel>
		</ui:define>
	</ui:composition>
</h:body>
</html>